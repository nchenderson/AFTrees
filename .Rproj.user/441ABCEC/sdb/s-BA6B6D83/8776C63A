{
    "collab_server" : "",
    "contents" : "\nlibrary(survival)\nlibrary(pracma)\nnreps <- 2\nz1 <- z2 <- z11 <- z12 <- rep(0, nreps)\nThetaMat1 <- ThetaMat2 <- matrix(0, nrow=1000, ncol=nreps)\nfor(h in 1:nreps) {\nn <- 500\nage <- runif(n)\nage <- sort(age)\nmuvec <- muvec_trt <- theta.true <- rep(0, n)\nfor(k in 1:n) {\n  muvec[k] <- 1/2 + pnorm(5*(age[k] - .5))\n  muvec_trt[k] <- .35 + muvec[k]\n  theta.true[k] <- muvec_trt[k] - muvec[k]\n}\n\n## generate responses without censoring\na0 = muvec + rnorm(n)\na1 = muvec_trt + rnorm(n)\nyy = c(a0, a1)\n\nTrt <- c(rep(0,n), rep(1,n))\nXX <- matrix(rep(age,2), ncol=1)\n\naftFit <- IndivAFT(XX,exp(yy),status=rep(1,2*n),Trt=Trt,ndpost=500,nskip=500,printevery=100)\naftFit2 <- IndivAFTSeparate(XX, exp(yy), status=rep(1,2*n), Trt=Trt, ndpost=500, nskip=500, printevery=100)\n\n#aftFit3 <- AFTrees(XX, exp(yy), status=rep(1,2*n), ndpost=500, nskip=500, printevery=100)\n\nTheta.hat1 <- colMeans(aftFit$Theta)\nTheta.hat2 <- colMeans(aftFit2$Theta)\n\nplot(Theta.hat1, Theta.hat2)\nabline(0, 1)\n\n\nz1[h] <- mean((Theta.hat1 - theta.true)^2)\nz2[h] <- mean((Theta.hat2 - theta.true)^2)\nz11[h] <- var(Theta.hat1)\nz12[h] <- var(Theta.hat2)\n\nThetaMat1[,h] <- Theta.hat1\nThetaMat2[,h] <- Theta.hat2\n}\n\nsummary(z1)\nsummary(z2)\nsummary(z11)\nsummary(z12)\n\nmean(abs(mean(colMeans(ThetaMat1)) - theta.true))\nmean(abs(mean(colMeans(ThetaMat2)) - theta.true))\n\n\n\n\n\nn <- 500\nage <- runif(n)\nage <- sort(age)\nmuvec <- muvec_trt <- theta.true <- rep(0, n)\nfor(k in 1:n) {\n  muvec[k] <- 1/2 + pnorm(5*(age[k] - .5))\n  muvec_trt[k] <- ifelse(age[k] < .6, .35 + muvec[k], .8 + muvec[k])\n  theta.true[k] <- muvec_trt[k] - muvec[k]\n}\n\n## generate responses without censoring\na0 = muvec + rnorm(n)\na1 = muvec_trt[1:300] + rnorm(300)\nyy = c(a0, a1)\n\nTrt <- c(rep(0,n), rep(1,300))\nXX <- matrix(c(age,age[1:300]), ncol=1)\n\naftFit <- IndivAFT(XX,exp(yy),status=rep(1,nrow(XX)),Trt=Trt,ndpost=500,nskip=500,printevery=100)\naftFit2 <- IndivAFTSeparate(XX, exp(yy), status=rep(1, nrow(XX)), Trt=Trt, ndpost=500, nskip=500, printevery=100)\n\n#aftFit3 <- AFTrees(XX, exp(yy), status=rep(1,2*n), ndpost=500, nskip=500, printevery=100)\n\nTheta.hat1 <- colMeans(aftFit$Theta)\nTheta.hat2 <- colMeans(aftFit2$Theta)\n\nq1_up <- apply(aftFit$Theta, 2, function(x) quantile(x, probs=.975))\nq1_low <- apply(aftFit$Theta, 2, function(x) quantile(x, probs=.025))\nq2_up <- apply(aftFit2$Theta, 2, function(x) quantile(x, probs=.975))\nq2_low <- apply(aftFit2$Theta, 2, function(x) quantile(x, probs=.025))\n\n\nplot(XX[,1], Theta.hat1)\npoints(XX[,1], .2*XX[,1] + .35, col=\"red\")\nabline(0, 1)\n\n\n\nn <- 500\nage <- runif(n)\nage <- sort(age)\nmuvec <- muvec_trt <- theta.true <- rep(0, n)\nfor(k in 1:n) {\n  muvec[k] <- 1/2 + pnorm(5*(age[k] - .5))\n  muvec_trt[k] <- ifelse(age[k] < .6, .35 + muvec[k], .8 + muvec[k])\n  theta.true[k] <- muvec_trt[k] - muvec[k]\n}\n\n## generate responses without censoring\na0 = muvec + rnorm(n)\na1 = muvec_trt + rnorm(n)\nyy = c(a0, a1)\n\nTrt <- c(rep(0,n), rep(1,n))\nXX2 <- matrix(rep(age,2), ncol=1)\n\naftFit <- IndivAFT(XX2,exp(yy),status=rep(1,2*n),Trt=Trt,ndpost=500,nskip=500,printevery=100)\n#aftFit2 <- IndivAFTSeparate(XX, exp(yy), status=rep(1,2*n), Trt=Trt, ndpost=500, nskip=500, printevery=100)\n\n#aftFit3 <- AFTrees(XX, exp(yy), status=rep(1,2*n), ndpost=500, nskip=500, printevery=100)\n\nTheta.hat11 <- colMeans(aftFit$Theta)\n#Theta.hat2 <- colMeans(aftFit2$Theta)\nq11_up <- apply(aftFit$Theta, 2, function(x) quantile(x, probs=.975))\nq11_low <- apply(aftFit$Theta, 2, function(x) quantile(x, probs=.025))\n\n\nuu <- ifelse(XX[,1] < .6, .35, .8)\nplot(XX[,1], Theta.hat1,ylim=c(-1, 2))\npoints(XX[,1], uu, col=\"red\")\npoints(XX2[,1], Theta.hat11, col=\"blue\")\nlines(XX[,1], q1_low, col=\"black\")\nlines(XX[,1], q1_up, col=\"black\")\nlines(XX2[,1], q11_low, col=\"blue\")\nlines(XX2[,1], q11_up, col=\"blue\")\npoints(XX[,1], Theta.hat2, col=\"green\")\nlines(XX[,1], q2_low, col=\"green\")\nlines(XX[,1], q2_up, col=\"green\")\n\n\n\n",
    "created" : 1521495790995.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "148546831",
    "id" : "8776C63A",
    "lastKnownWriteTime" : 1523895771,
    "last_content_update" : 1523895771692,
    "path" : "~/personalized/twoarms_try.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled37"
    },
    "relative_order" : 32,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}